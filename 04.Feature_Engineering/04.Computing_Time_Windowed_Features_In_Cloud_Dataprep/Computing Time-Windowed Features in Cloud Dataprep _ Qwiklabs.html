<!DOCTYPE html>
<!-- saved from url=(0049)https://googlecoursera.qwiklabs.com/focuses/35219 -->
<html lang="en" class="mdl-js"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" crossorigin="anonymous" href="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/main.css"><script src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/nr-1130.min.js.download"></script><script type="text/javascript" async="" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/analytics.min.js.download"></script><script type="text/javascript" id="www-widgetapi-script" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/www-widgetapi.js.download" async=""></script><script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"caff0d62ed","applicationID":"29451451","transactionName":"IQ1XRUEOVV1dFxlRXAEXSlRATkpZVxI=","queueTime":0,"applicationTime":147,"agent":""}</script>
<script>window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1130.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script>
<meta content="[]" name="active-experiments">
<meta content="{&quot;userId&quot;:1018107}" name="help-api-product-data">
<meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="DvpniHgSgcVJ1DgKsiLynwMo0CkGxf+QyTh2/pbONBBJlKO9uLggxxyst4ejGCC98XLQmoPR5GFXtVCqy6hfRg==">
<title>Computing Time-Windowed Features in Cloud Dataprep | Qwiklabs</title>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0" name="viewport">
<meta content="In this lab you will ingest, transform, and analyze a taxi cab dataset using Google Cloud Dataprep. We will calculate key reporting metrics like the average number of passengers picked up in the past hour. " name="description">
<meta content="Qwiklabs" name="author">
<meta content="1rRsY0INj8RvwB5EF5pwdxt2A2P9aDgAlsICaJ0d5w0" name="google-site-verification">
<meta content="Computing Time-Windowed Features in Cloud Dataprep | Qwiklabs" property="og:title">
<meta content="website" property="og:type">
<meta content="/favicon-144.png" property="og:image">
<meta content="Qwiklabs" property="og:site_name">
<meta content="In this lab you will ingest, transform, and analyze a taxi cab dataset using Google Cloud Dataprep. We will calculate key reporting metrics like the average number of passengers picked up in the past hour. " property="og:description">
<meta content="/qwiklabs_logo_900x887.png" property="og:logo" size="900x887">
<meta content="/qwiklabs_logo_994x187.png" property="og:logo" size="994x187">
<meta content="#3681E4" property="msapplication-TileColor">
<meta content="/favicon-144.png" property="msapplication-TileImage">
<link href="https://googlecoursera.qwiklabs.com/favicon-32.png" rel="shortcut icon">
<link color="#3681E4" href="https://googlecoursera.qwiklabs.com/favicon-svg.svg" rel="mask-icon">
<link href="https://googlecoursera.qwiklabs.com/favicon-180.png" rel="apple-touch-icon-precomposed">
<link rel="stylesheet" media="screen" href="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/css">


<!--[if lt IE 9]>
<script src='http://html5shim.googlecode.com/svn/trunk/html5.js' type='text/javascript'></script>
<![endif]-->
<!--[endif]>  <![endif]-->
<script>
//<![CDATA[
window.gon={};gon.current_user={"firstname":"Saifullah al","lastname":"Mujahid","fullname":"Saifullah al Mujahid","company":"Login with Google","email":"mujahid7292@gmail.com","origin":"google-run, direct, nEHJKyBzts1wgcYE7A3w","subscriptions":1,"id":"594ecfdd6abffec37cc71dd7002ec821","qlCreatedAt":"2018-08-09 10:26:13 UTC","optIn":true};gon.segment="j4Im8pqIko0Lxq4wVVZWMPMM0EroHUvb";gon.deployment="googlecoursera-run";
//]]>
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "WebSite",
  "url": "https://www.qwiklabs.com/",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://www.qwiklabs.com/catalog?keywords={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
<script id="ze-snippet" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/snippet.js.download"></script><script type="text/javascript" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/asset_composer.5e12e43b022a913c3713.js.download" charset="utf-8" async=""></script>



<link rel="stylesheet" media="all" href="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/application-61450108c876600fe205f3b521c64ce6ccab850d1e743.css">
<script>
  EVENT_SOURCE_BASE_URL = "https://googlecoursera-run.qwiklabs.com/nchan-sub?id=";
</script>
<script src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/webcomponents-loader.js.download"></script>
<script src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/hallofmirrors-558606143472f1ee7ddacd0ec320b22ceef36d.download"></script><script async="" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/lazy.min.js.download"></script>
<script src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/iframe_api"></script>
<script src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/vendor-45d462772c30000424907184f70c7157e95fb6227698d.download"></script>
<script src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/application-7be06fbcf4fa5d69b12903f29f2dc5cced59be75.download"></script>
<style type="text/css" nonce="BAE0813D03F4C24A9CF27BAF158B34E6">#AD_Top,#AD_banner,#AdColumn,#AdContainer,#AdHeader,#AdImage,#Adcode,#AdvertiseFrame,#Advertisements,#BottomAdContainer,#BottomAds,#ContentAd,#PreRollAd,#RightAdBlock,#TopAd,#WNAd41,#ad-area,#ad-background,#ad-bg,#ad-container,#ad-header,#ad-header-728x90,#ad-leaderboard,#ad-main,#ad-panel,#ad-rotator,#ad-text,#ad-top,#ad-top-banner-placeholder,#ad-top-wrapper,#ad-unit,#ad-wrapper,#ad468,#ad728,#ad728x90,#adBanner,#adBelt,#adComponentWrapper,#adDiv,#adFrame,#adGallery,#adHeader,#adHolder,#adLayer,#adLeader,#adPosition0,#adText,#ad_1,#ad_2,#ad_3,#ad_4,#ad_5,#ad_728_90,#ad_area,#ad_banner,#ad_center,#ad_content,#ad_header,#ad_leaderboard,#ad_main,#ad_overlay,#ad_space,#ad_square,#ad_table,#ad_topslot,#ad_unit,#ad_wrap,#ad_wrapper,#adaptv_ad_player_div,#adbackground,#adbanner,#adbar,#adblock,#adboard,#adbody,#adbox,#adcode,#adcontainer,#adcontainer1,#adcontent,#adhead,#adheader,#adimg1,#adlayer,#adnews,#adposition3,#adright,#ads-col,#ads-wrapper,#ads1,#adsHeader,#adsIframe,#ads_bottom,#ads_right,#ads_top,#ads_wrapper,#adsdiv,#adsense,#adsense_block,#adsense_inline,#adsensewide,#adspace,#adspace_top,#adspot-300x250-pos-1,#adspot-300x250-pos-2,#adstop,#adtext,#adtop,#adv-masthead,#adv-top,#advert1,#advert2,#advertContainer,#advert_box,#advertise,#advertisement1,#advertisetop,#advertising_wrapper,#adverts,#advtop,#adwrapper,#banner-ad,#bannerAd,#bannerAdWrapper,#banner_topad,#bannerad,#bigAd,#bigad,#body_ad,#bottomAd,#bottomAds,#bottom_ad,#bottomads,#centerads,#cmn_ad_tag_head,#content-header-ad,#contentAd,#content_ads,#content_adv,#contentad,#ctlDisplayAd1_lblAd,#dart-container-728x90,#dfp_ad_Entry_728x90,#dfp_ad_Home_728x90,#divAd,#div_prerollAd_1,#download_ad,#featuread,#featured-ads,#featuredAds,#footer_ad,#footer_ads,#game-ad,#googlead,#gridAdSidebar,#head-ad,#header-ads,#headerAd,#headerAdContainer,#header_ad,#homead,#ka_adRightSkyscraperWide,#leaderAd,#leaderBoardAd,#leaderboard-ad,#leaderboard-advertisement,#leaderboardad,#left-ad,#left_ads,#leftad,#leftads,#logoAd,#logo_ad,#mainAd,#main_ad,#mpu2,#mpu2_container,#mpu_container,#msad,#my-adsFPAD,#myAd,#player_ads,#pre_advertising_wrapper,#prerollAd,#promo-ad,#publicidad,#reklama,#rh-ad,#right_ads,#right_adsense,#search-sponsor,#searchAd,#search_ads,#sideAd,#side_ads,#sidebar-ads,#sidebar_ads,#skybox-ad,#sponsorAdDiv,#sponsoredwellcontainerbottom,#sponsors-home,#takeover_ad,#text-ads,#theAd,#top-ad,#top-ad-content,#topAd,#topAdSpace,#topAdSpace_div,#topAds,#topAdvert,#topBannerAd,#top_ad,#top_ads,#topad,#topadvert,#topbannerad,#under_story_ad,#videoAd,#videoAdContainer,#videoads,.ADBAR,.AdBar,.AdBody:not(body),.AdBox,.AdInfo,.AdSidebar,.AdTitle,.AdvertContainer,.HomeAds,.IM_ad_unit,.RelatedAds,.SponsoredContent,.aalb-pa-ad-unit,.aalb-pg-ad-unit,.ad-300x250,.ad-970,.ad-banner,.ad-block,.ad-body,.ad-border,.ad-btn,.ad-button,.ad-cat,.ad-cell,.ad-display,.ad-enabled,.ad-fixed,.ad-grid,.ad-header,.ad-holder,.ad-icon,.ad-img,.ad-inner,.ad-item,.ad-leader-top,.ad-leaderboard,.ad-left,.ad-link,.ad-links,.ad-loaded,.ad-panel,.ad-placement,.ad-rail,.ad-right,.ad-row,.ad-scroll,.ad-section,.ad-served,.ad-sidebar,.ad-source,.ad-square,.ad-stack,.ad-text,.ad-top,.ad-unit,.ad-unit-300-wrapper,.ad-vertical-container,.ad-wide,.ad-wrap,.ad-wrapper,.ad300,.ad468,.ad728,.ad90,.adBar,.adBlock,.adBottomBoard,.adBox,.adChoicesLogo,.adContent,.adDiv,.adElement,.adFrame,.adFrameCnt,.adHead,.adHeader,.adHeaderblack,.adHeadline,.adHolder,.adHoldert,.adImg,.adItem,.adLink,.adMessage,.adMiddle,.adMod,.adModule,.adOverlay,.adPanel,.adPod,.adResult,.adRight,.adRotator,.adSpace,.adSpot,.adText,.adTitle,.adTopHome,.adWidget,.adWrap,.ad_1,.ad_160,.ad_160x600,.ad_2,.ad_3,.ad_728x90,.ad_960,.ad_Right,.ad_block,.ad_body,.ad_bottom,.ad_box,.ad_container,.ad_description,.ad_global_header,.ad_head_rectangle,.ad_header,.ad_img,.ad_item,.ad_leaderboard,.ad_middle,.ad_outer,.ad_promo,.ad_slug_table,.ad_space,.ad_spot,.ad_text,.ad_title,.ad_trick_header,.ad_trick_left,.ad_wrap,.ad_wrapper,.adarea,.adbanner,.adbar,.adbottom,.adbutton,.adcenter,.adcolumn,.adcont,.addiv,.adframe,.adfree,.adheader,.adholder,.adinfo,.adkit,.adlink,.adlist,.admain,.admiddle,.adright,.adrow1,.adrow2,.ads-1,.ads-2,.ads-3,.ads-300-250,.ads-area,.ads-bg,.ads-col,.ads-header,.ads-holder,.ads-inline,.ads-item,.ads-list,.ads-right,.ads-section,.ads-title,.ads-top,.ads1,.adsBlock,.adsWidget,.ads_catDiv,.ads_div,.ads_top,.ads_wrapper,.adsbottombox,.adsbox,.adsbygoogle,.adscontainer,.adsense_wrapper,.adshome,.adside,.adsizewrapper,.adslot,.adslot_blurred,.adspace,.adtable,.adtile,.adtop,.adv-box,.adv-list,.adv300,.advBox,.adv_300,.adv_txt,.advert-block,.advert-box,.advert-container,.advert-content,.advert-horizontal,.advert-wrapper,.advert2,.advertColumn,.advertContainer,.advertLink,.advertText,.advert_area,.advert_container,.advert_list,.advertbox,.advertisement-1,.advertisement-block,.advertisement__leaderboard,.advertiser,.advertising_banner,.advertising_block,.advertisment,.advertorial,.adverts,.adverttext,.adwords,.afs_ads,.after-post-ad,.article-advert,.article_ad,.b-advert,.b-banner,.banner-ad,.banner-ad-container,.banner-ads,.banner160x600,.banner300,.bannerAd,.banner_728x90,.banner_ad,.bannerad,.block-ad,.block-ec_ads,.block-simpleads,.blog-ads,.bottom-ad,.bottom-ads,.bottom-left-ad,.bottomAds,.bottom_ad_block,.box-ads,.box-radvert,.box-recommend-ad,.box_ads,.box_adv,.boxad,.boxadv,.btn-ad,.can_ad_slug,.category-ad,.change_AdContainer,.chitikaAdBlock,.container_ad,.container_row_ad,.content-ad,.contentAd,.contentAds,.content_ads,.content_tagsAdTech,.cp-adsInited,.custom-ad,.ddb,.desktop-ad,.dfp-ad,.dfp-ad-unit,.dfp-tag-wrapper,.displayAd,.download_ad,.easyazon-block,.ec-ads-remove-if-empty,.featured-ad,.featuredAdBox,.flash-advertisement,.footer-ad,.footer-ads,.footer_ad,.footerad,.forumAd,.gallery-ad,.google-sponsored,.googleAdSense,.googleAds,.greyAd,.grid-item-ad,.has-ad,.hasads,.header-ad,.headerAd,.header_ad,.header_ad_center,.header_advert,.headerad,.headerads,.home-ad,.home-ads,.homeAd,.homead,.homepage-ad,.homepage_ads,.horizontal_ad,.img_ad,.imgad,.inner_ad,.innerad,.insert-post-ads,.ipsAd,.item-ads,.item-container-ad,.js-sticky-ad,.jw-ad,.leaderboard-ad,.leaderboard-ads,.leftAd,.leftad,.list-ad,.list-ads,.listad,.logo-ad,.m-in-content-ad-row,.marketing-ad,.mid_ad,.middle_AD,.module-ad,.nativead,.nav-ad,.newsAd,.node-ad,.oasad,.oio-banner-zone,.openx,.overlay-ads,.page-ad,.page_ad,.plainAd,.playerAd,.player_ad,.player_hover_ad,.post-ad,.post-sponsored,.post_ad,.postad,.premiumAdOverlay,.premiumAdOverlayClose,.promoAd,.pub_300x250,.pub_300x250m,.pub_728x90,.publicidade,.pushdown-ad,.rail-ad,.rbRectAd,.rectangle_ad,.refreshAds,.region-top-ad-position,.reklam,.reklama,.reportAdLink,.resultad,.review-ad,.right-ad,.rightAd,.right_ad,.right_ads_column,.rightad,.rightadv,.searchAds,.searchad,.searchads,.section-sponsor,.showAd,.showads,.side-ad,.side-bar-ad-position1,.sideAd,.sidebar-ads,.sidebar_advert,.single-ad,.singleAd,.skinAd,.sky_ad,.skyscraperAd,.slide-ad,.smallAd,.small_ad,.smallads,.sponsor-box,.sponsor-logo,.sponsorBlock,.sponsorBottom,.sponsoredLinks,.sponsorlink,.sticky-ad,.story-ad,.taboola-ad,.tc_ad_unit,.td-ad,.td-header-ad-wrap,.text-ad,.text-ad-links,.text-ads,.textAd,.text_ad,.text_ads,.textad,.textads,.top-ad,.top-ad-container,.top-ad-content,.top-ad-wrapper,.top-advert,.topAds,.top_ad,.top_ad_div,.top_ad_wrap,.top_ads,.topads,.tower-ad,.trc-content-sponsored,.trc_rbox .syndicatedItem,.trc_rbox_border_elm .syndicatedItem,.trc_rbox_div .syndicatedItem,.trc_related_container div[data-item-syndicated="true"],.type_ads_default,.vertical-ads,.view_ad,.wideAd,.withAds,.wnad,.wpInsertInPostAd,.wp_bannerize,.yom-ad,[href*="xlovecam.com/promo/tracking/"],[href^="http://in.mydirtyhobby.com/track/"],[href^="http://join.allofgfs.com/track/"],[href^="http://join.freshgfs.com/track/"],[href^="http://join.innocenthigh.com/track/"],[href^="http://join.muffx.com/track/"],[href^="http://join.seemygf.com/track/"],[href^="http://join.self-shot.com/track/"],[href^="http://join.teengfsex.com/track/"],[href^="http://myalternativegflink.com/track/"],[href^="http://secure.18exgfs.com/track/"],[href^="http://secure.badassgirlfriends.com/track/"],[href^="http://secure.bustygfsexposed.com/track/"],[href^="http://secure.chatrevenge.com/track/"],[href^="http://secure.dagfs.com/track/"],[href^="http://secure.fubilov.com/track/"],[href^="http://secure.hotgfvideos.com/track/"],[href^="http://secure.mynngf.com/track/"],[href^="http://secure.obsessedwithmyself.com/track/"],[href^="http://secure.publicgfvideos.com/track/"],[href^="http://secure.realgfsexposed.com/track/"],[href^="http://secure.slutswithphones.com/track/"],[href^="http://secure.watchmygf.com/track/"],a[href*=".revimedia.com/"],a[href*=".trust.zone"],a[href*="/adrotate-out.php?"],a[href*="/relap.io/adv/"],a[href*="marketgid.com/"],a[href*="medicinetizer.ru"],a[href*="runetki.com"],a[href*="universallnk.com"],a[href^="//awejmp.com/"],a[href^="http://ad-emea.doubleclick.net/"],a[href^="http://ad.doubleclick.net/"],a[href^="http://adfarm.mediaplex.com/"],a[href^="http://ads.betfair.com/redirect.aspx?"],a[href^="http://ads2.williamhill.com/redirect.aspx?"],a[href^="http://adserving.unibet.com/"],a[href^="http://adultfriendfinder.com/p/register.cgi?pid="],a[href^="http://affiliate.coral.co.uk/processing/"],a[href^="http://marketgid.com"],a[href^="http://mgid.com/"],a[href^="http://online.ladbrokes.com/promoRedirect?"],a[href^="http://pubads.g.doubleclick.net/"],a[href^="http://us.marketgid.com"],a[href^="http://www.adskeeper.co.uk/"],a[href^="http://www.fbooksluts.com/"],a[href^="http://www.fleshlight.com/"],a[href^="http://www.liutilities.com/"],a[href^="http://www.socialsex.com/"],a[href^="http://www.yourfuckbook.com/?"],a[href^="https://ad.doubleclick.net/"],a[href^="https://badoinkvr.com/"],a[href^="https://servedbyadbutler.com/"],a[href^="https://tc.tradetracker.net/"],a[href^="https://www.financeads.net/tc.php?"],a[onmousedown^="this.href='https://paid.outbrain.com/network/redir?"][target="_blank"],div[data-native_ad],div[id^="MarketGid"],div[id^="advads-"],div[id^="dfp-ad-"],div[id^="div-gpt-ad"],div[id^="google_ads_iframe_"],div[itemtype="http://schema.org/WPAdBlock"],iframe[id^="google_ads_frame"],iframe[id^="google_ads_iframe"],iframe[src*=".cameraprive.com"],iframe[src^="http://ad.yieldmanager.com/"] {display: none !important; color: #93e41c !important; background-color: #6e2091 !important;}</style></head>
<body class="focuses focuses-show lab-show l-full no-nav">
<div class="header-container">
<div class="header">
<a class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect header__button header__button--nav header__nav-panel-button js-nav-toggle" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">menu</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<div class="header__title">
<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button header__button--nav" href="https://www.coursera.org/" data-upgraded=",MaterialButton,MaterialRipple"><ql-icon>arrow_back</ql-icon><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>

<h1 class="headline-5">
Computing Time-Windowed Features in Cloud Dataprep
</h1>
</div>
<div class="header__actions">
<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button header__button--action header__button--search js-header-search-bar-button" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">search</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>

<ql-help context="lab" productdata="{&quot;userId&quot;:1018107}"></ql-help>
<a class="header-my-account-button mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect js-my-account-button" data-upgraded=",MaterialButton,MaterialRipple">
<img class="avatar " src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/446d5a9572a0ed0a6dd56cb9e8666994.png">
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<div class="header-my-account-menu js-my-account-menu">
<div class="card elevation-2 no-padding">
<div class="my-account-menu__top">
<img class="avatar " src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/446d5a9572a0ed0a6dd56cb9e8666994.png">
<div class="my-account-menu__info">
<h4 class="subtitle-headline-1">
Saifullah al Mujahid
</h4>
<p class="body-2 text--gray">
<span>mujahid7292@gmail.com</span>
</p>
<a class="button" href="https://googlecoursera.qwiklabs.com/my_account/profile">My Account</a>
</div>
</div>
<div class="my-account-menu__bottom">
<a class="text--green subtitle-headline-2" href="https://googlecoursera.qwiklabs.com/my_account/credits">Monthly Subscription
</a><a class="button button--hairline" rel="nofollow" data-method="delete" href="https://googlecoursera.qwiklabs.com/users/sign_out">Sign out</a>
</div>
</div>
</div>

</div>
</div>
</div>
<div class="header__search-bar js-header-search-bar">
<form id="catalog-search-mobile" onsubmit="ql.catalogSearchFilter(); return false;" action="https://googlecoursera.qwiklabs.com/searches/elasticsearch" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="✓"><input type="hidden" name="authenticity_token" value="DvpniHgSgcVJ1DgKsiLynwMo0CkGxf+QyTh2/pbONBBJlKO9uLggxxyst4ejGCC98XLQmoPR5GFXtVCqy6hfRg==">
<input type="text" name="keywords" id="keywords" placeholder="Search" maxlength="255">
</form>

<a class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect header__button" data-upgraded=",MaterialButton,MaterialRipple">
<i class="material-icons">close</i>
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
</div>

<nav class="nav-bar">
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/"><ql-icon class="nav-bar__item__icon">
home
</ql-icon>
<span class="nav-bar__item__label">
Home
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/catalog"><ql-icon class="nav-bar__item__icon">
school
</ql-icon>
<span class="nav-bar__item__label">
Catalog
</span>
</a>
<a class="nav-bar__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_learning"><ql-icon class="nav-bar__item__icon">
event_note
</ql-icon>
<span class="nav-bar__item__label">
My Learning
</span>
</a>
</nav>

<nav class="nav-panel js-nav-panel">
<div class="nav-panel__logo">
<div class="logo logo--blue"></div>
</div>
<a title="Home" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/"><ql-icon class="nav-panel__item__icon">
home
</ql-icon>
<div class="nav-panel__item__label">
Home
</div>
</a>
<a title="Catalog" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/catalog"><ql-icon class="nav-panel__item__icon">
school
</ql-icon>
<div class="nav-panel__item__label">
Catalog
</div>
</a>
<a title="My Learning" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_learning"><ql-icon class="nav-panel__item__icon">
event_note
</ql-icon>
<div class="nav-panel__item__label">
My Learning
</div>
</a>
<div class="nav-panel__spacer"></div>
<a title="Profile" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/profile"><ql-icon class="nav-panel__item__icon">
account_circle
</ql-icon>
<div class="nav-panel__item__label">
Profile
</div>
</a>
<a title="Credits &amp; Subscriptions" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/credits"><ql-icon class="nav-panel__item__icon">
money
</ql-icon>
<div class="nav-panel__item__label">
Credits &amp; Subscriptions
</div>
</a>
<a title="Security" tabindex="-1" class="nav-panel__item js-navigation-button" href="https://googlecoursera.qwiklabs.com/my_account/security"><ql-icon class="nav-panel__item__icon">
security
</ql-icon>
<div class="nav-panel__item__label">
Security
</div>
</a>
<div class="nav-panel__spacer"></div>
<a class="nav-panel__item" tabindex="-1" href="https://googlecoursera.qwiklabs.com/focuses/35219#"><ql-help>
<div class="nav-panel__help-item">
<ql-icon class="nav-panel__item__icon">help</ql-icon>
<div class="nav-panel__item__label">Help</div>
</div>
</ql-help>
</a><div class="nav-panel__small-links">
<a tabindex="-1" href="https://googlecoursera.qwiklabs.com/privacy_policy">Privacy</a>
<a tabindex="-1" href="https://googlecoursera.qwiklabs.com/terms_of_service">Terms</a>
</div>
</nav>
<div class="nav-panel__overlay js-nav-toggle"></div>

<main class="js-main">
<span class="hidden" id="flash-sibling-before"></span>

<div class="l-main-wrapper" id="main-wrapper">







<div class="js-lab-state" data-analytics-payload="{&quot;label&quot;:&quot;Computing Time-Windowed Features in Cloud Dataprep&quot;,&quot;lab_name&quot;:&quot;Computing Time-Windowed Features in Cloud Dataprep&quot;,&quot;classroom_name&quot;:null,&quot;deployment&quot;:&quot;googlecoursera-run&quot;}" data-focus-id="35219" data-lab-billing-limit="0.0" data-lab-duration="7200" data-parent="classroom"></div>
<ql-lab-control-panel class="js-lab-control-panel l-lab-control-panel" connectiondetails="[]" connectionfiles="[]" labcontrolbutton="{&quot;disabled&quot;:false,&quot;pending&quot;:false,&quot;running&quot;:false}" labtimer="{&quot;ticking&quot;:false,&quot;secondsRemaining&quot;:7200}" studentresources="[]"></ql-lab-control-panel>
<div class="l-lab-main-body">
<div class="js-lab-content lab-content">
<div class="alert alert--fake js-alert">
<p class="alert__message js-alert-message"></p>
<a class="alert__close js-alert-close">
<i class="fa fa-times"></i>
</a>
<iframe class="l-ie-iframe-fix" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/saved_resource.html"></iframe>
</div>
<div class="lab-content__markdown-wrapper">
<div class="lab-preamble">
<h1 class="lab-preamble__title">
Computing Time-Windowed Features in Cloud Dataprep
</h1>
<div class="lab-preamble__details subtitle-headline-1">
<span>2 hours </span>
<span>Free</span>
<div class="lab__rating">
<a href="https://googlecoursera.qwiklabs.com/focuses/35219/reviews?parent=catalog"><div class="rateit" data-rateit-readonly="true" data-rateit-value="4.3223"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 69.1568px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>

</a><a data-target="#lab-review-modal" data-toggle="modal">
Rate Lab
</a>
</div>
</div>
</div>

<div class="lab-content__inner-wrapper">
<div class="js-markdown-instructions lab-content__markdown markdown-lab-instructions" id="markdown-lab-instructions">



<h2 id="step1">Overview</h2>
<p>In this lab you will ingest, transform, and analyze a taxi cab dataset using Google Cloud Dataprep. We will calculate key reporting metrics like the average number of passengers picked up in the past hour.</p>
<h3>What you learn</h3>
<p>In this lab, you:</p>
<ul>
<li>Build a new Flow using Cloud Dataprep</li>
<li>Create and chain transformation steps with recipes</li>
<li>Running Cloud Dataprep jobs (Dataflow behind-the-scenes)</li>
</ul>
<p>Cloud Dataprep is Google's self-service data preparation tool. In this lab, you will learn how to clean and enrich multiple datasets using Cloud Dataprep.</p>
<h2 id="step2">Setup</h2>
<p>For each lab, you get a new GCP project and set of resources for a fixed time at no cost.</p>
<ol>
<li>
<p>Make sure you signed into Qwiklabs using an <strong>incognito window</strong>.</p>
</li>
<li>
<p>Note the lab's access time (for example, <img alt="img/time.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/aZQJ4BT7uCmM9XR6BTXgTRP1Hfu1T7q6V+cnbdEsbpU="> and make sure you can finish in that time block.</p>
</li>
</ol>
<aside> <p>
  There is no pause feature. You can restart if needed, but you have to start at the beginning.
  </p>

</aside>
<ol start="3">
<li>
<p>When ready, click <img alt="img/start_lab.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/XE8x7uvQokyubNwnYKKc+vBBNrMlo5iNZiDDzQQ3Ddo=">.</p>
</li>
<li>
<p>Note your lab credentials. You will use them to sign in to Cloud Platform Console.
<img alt="img/open_google_console.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/0d78dhX6IVMVWmixCPPSBbmi5O2GPokCXf1Ps1AkTgI="></p>
</li>
<li>
<p>Click <strong>Open Google Console</strong>.</p>
</li>
<li>
<p>Click <strong>Use another account</strong> and copy/paste credentials for <strong>this</strong> lab into the prompts.</p>
</li>
</ol>
<aside class="warning"><p>If you use other credentials, you'll get errors or <strong>incur charges</strong>.
  </p>
</aside>
<ol start="7">
<li>Accept the terms and skip the recovery resource page.</li>
</ol>
<aside class="warning"><p>Do not click <strong>End Lab</strong>unless you are finished with the lab or want to restart it. This clears your work and removes the project.
  </p>
</aside>

<h2 id="step3">Create a new Storage Bucket</h2>
<p><em>Skip this section if you already have a GCS Bucket</em></p>
<h4>Step 1</h4>
<p>Open the <strong>Google Cloud Console</strong> at  <a href="http://console.cloud.google.com/">console.cloud.google.com</a>.</p>
<h4>Step 2</h4>
<p>Go to <strong>Storage</strong> in the <strong>Navigation menu</strong> (left-side navigation).</p>
<h4>Step 3</h4>
<p>Click <strong>Create Bucket</strong> (or use an existing bucket).</p>
<h4>Step 4</h4>
<p>In the Create a bucket window that will appear, add a unique bucket name and leave the remaining settings at their default values.</p>
<h4>Step 5</h4>
<p>Click <strong>Create</strong>.</p>
<h4>Step 6</h4>
<p>You now have a Cloud Storage Bucket which we will be using to store raw data for ingestion into Google BigQuery later and for storing Cloud Dataprep settings.</p>
<h2 id="step4">Create BigQuery Dataset to store Cloud Dataprep Output</h2>
<h4>Step 1</h4>
<p>Open <strong>BigQuery</strong> at  <a href="https://console.cloud.google.com/bigquery">https://console.cloud.google.com/bigquery</a>.</p>
<h4>Step 2</h4>
<p>In the left side bar, <strong>click on your project</strong> name.</p>
<h4>Step 3</h4>
<p>Click <strong>CREATE DATASET</strong>.</p>
<h4>Step 4</h4>
<p>For Dataset ID, type <strong>taxi_cab_reporting</strong> and select <strong>Create dataset</strong>.</p>
<p>Now you have a new empty dataset that we can populate with tables.</p>
<h2 id="step5">Launch Cloud Dataprep</h2>
<h4>Step 1</h4>
<p>Open the <strong>Navigation menu</strong>.</p>
<h4>Step 2</h4>
<p>Under Big Data, click on <strong>Dataprep</strong>.</p>
<h4>Step 3</h4>
<p><strong>Agree</strong> to the Terms of Service.</p>
<h4>Step 4</h4>
<p>Click <strong>Agree and Continue</strong>.</p>
<p><img alt="5eabff1419ebfaea.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/6Xi3MOf1YfgI4pW2irPAnDTXRuxTALHssGTWJtWOkwA="></p>
<p>Click <strong>Allow</strong> for Trifacta to access project data. Dataprep is provided in collaboration with Trifacta, a Google partner.
<img alt="59ddf08c1bbcf24b.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/9OwJJvEtnDuBeShG_SDALsSsKBFjWNQy3f8yReSFPgY="></p>
<h4>Step 5</h4>
<p>Click <strong>Allow</strong>.</p>
<p><img alt="18fc12676fc080ed.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/v1EnFKe7QSvS32QHGa_qVFkp7L2MwCzpEfbPWXyDUxE="></p>
<h4>Step 6</h4>
<p>When prompted for "First Time Setup", click <strong>Continue</strong>.</p>
<h4>Step 7</h4>
<p>Wait for Cloud Dataprep to initialize (less than a minute typically).</p>
<h2 id="step6">Import NYC Taxi Data from GCS into a Dataprep Flow</h2>
<h4>Step 1</h4>
<p>In the Cloud Dataprep UI, click <strong>Create Flow</strong>.</p>
<h4>Step 2</h4>
<p>Specify the following <strong>Flow details:</strong></p>
<p><strong>Flow Name</strong></p><table>

</table>
<p>Click <strong>Create</strong>.</p>
<p>If prompted, dismiss the helper tutorial.</p>
<h4>Step 3</h4>
<p>Click <strong>Import &amp; Add Datasets</strong>.</p>
<h4>Step 4</h4>
<p>In the data importer left side menu, click <strong>GCS (Google Cloud Storage)</strong>.</p>
<h4>Step 5</h4>
<p>Click the <strong>Pencil Icon</strong> to edit the GCS path.</p>
<h4>Step 6</h4>
<p>Paste in the 2015 taxi rides dataset CSV from Google Cloud Storage:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">training</span><span class="pun">/</span><span class="pln">gcpml</span><span class="pun">/</span><span class="pln">c4</span><span class="pun">/</span><span class="pln">tlc_yellow_trips_2015_small</span><span class="pun">.</span><span class="pln">csv</span></code><button class="button button--copy js-copy-button-0"><i class="fa fa-clipboard"></i></button></pre>
<p>Click <strong>Go</strong>.</p>
<h4>Step 7</h4>
<p>Before selecting Import, click the Pencil Icon to <strong>edit the GCS path</strong> a second time and paste in the 2016 CSV below:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">gs</span><span class="pun">://</span><span class="pln">cloud</span><span class="pun">-</span><span class="pln">training</span><span class="pun">/</span><span class="pln">gcpml</span><span class="pun">/</span><span class="pln">c4</span><span class="pun">/</span><span class="pln">tlc_yellow_trips_2016_small</span><span class="pun">.</span><span class="pln">csv</span></code><button class="button button--copy js-copy-button-1"><i class="fa fa-clipboard"></i></button></pre>
<p>Click <strong>Go</strong>.</p>
<h4>Step 8</h4>
<p>Click <strong>Import &amp; Add to Flow</strong>.</p>
<p><img alt="step_8.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/COKwh6gFDcWVILVFP9WdZ7w_0JdlKpLhDWnvzdMzKJk="></p>
<h4>Step 9</h4>
<p><strong>Wait</strong> for the datasets to be loaded into DataPrep.</p>
<p>The tool loads up to a 10MB sample of the underlying data as well as connects to and ingests the original data source when the flow is ran.</p>
<h4>Step 10</h4>
<p>Click on the <strong>tlc_yellow_trips_2015_small</strong> icon and select <strong>Add New Recipe</strong>.</p>
<h4>Step 11</h4>
<p>Click <strong>Edit Recipe</strong>.</p>
<p>Wait for Dataprep to load your data sample into the explorer view</p>
<h4>Step 12</h4>
<p>In the explorer view, find the <strong>trip_distance</strong> column and examine the histogram.</p>
<p>True or False, the majority of the cab rides for 2015 were less than 2 miles?</p>
<p><img alt="step_12.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/aXstXYDV+LUx_dzb6qm3h7tOM_9j3I3wbuawe_oRNJg="></p>
<p><strong>True.</strong> In our sample, around 57% were between 0 to 2 miles.</p>
<p>Now, let's combine our 2016 and 2015 datasets.</p>
<h4>Step 13</h4>
<p>In the navigation bar, find the icon for <strong>Union</strong> and select it.</p>
<p><img alt="cc1a658aa4b1a32e.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/tpD7NxWulThEqnQY+_PBaUUCVmtN+9mZbg0kRjvPcKc="></p>
<h4>Step 14</h4>
<p>In the Union Page, click <strong>Add data</strong>.</p>
<p>In the popup window, select <strong>tlc_yellow_trips_2016_small</strong> and click <strong>Apply</strong>.</p>
<h4>Step 15</h4>
<p>Confirm the union looks like below (UNION DATA (2)) and then click <strong>Add to Recipe</strong>.</p>
<p><img alt="step_15.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/qSdrI1WyjjpzOb5KjLzZHlqyR_93QGoTXmw8jQWR4VQ="></p>
<p>Wait for Dataprep to Apply the Union.</p>
<p>Now we have a single table with 2016 and 2015 taxicab data.</p>
<h3><strong>Exploring your Data</strong></h3>
<h4>Step 16</h4>
<p>Examine the <strong>pickup_time</strong> histogram. Which hours had the fewest amount of pickups? The most?</p>
<p>In our sample, the early morning hours (5 - 6am) had the <strong>fewest</strong> taxicab pickups.</p>
<p><img alt="step_16_a.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/nTSlsJ1ht3q5uHG3SpNRuKEM+7sTq6WZ38dFvXsYdOU="></p>
<p>The most taxi cab pickups were in the evening hours with 19:00 (7pm) having slightly more than others.</p>
<p><img alt="step_16_b.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/yIKkJClku_n5zYLP6LCoTFqAwtJgUs6ZZjlz_aO2oqM="></p>
<p>Is this unusual? Would you expect NYC taxi cab trips to be clustered around lunch and earlier hours in the day? Let's continue exploring.</p>
<p>Examine the <strong>pickup_day</strong> histogram. Which months and years of data do we have in our dataset?</p>
<ul>
<li>Only December 2015 and December 2016</li>
</ul>
<p><img alt="step_16_c.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/NW_JIkCp4TdQC8Kc4BaOXCswlA1AahDcr0fhcx0UT_o="></p>
<p>Examine the <strong>dropoff_day</strong> histogram. Is there anything unusual about it when compared to pickup_day? Why are there records for January 2017?</p>
<p><img alt="step_16_d.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/pjscXqEurCu4deW9Lo3KV5jbOgOe32MiDBTf5UqTd7k="></p>
<p><strong>Answer:</strong> There are a few trips that start in December and end in January (spending New Years in a taxicab!).</p>
<p>Next, we want to concatenate our date and time fields into a single timestamp.</p>
<h4>Step 17</h4>
<p>In the navigation bar, find <strong>Merge columns</strong>.</p>
<p><img alt="step_17.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/q8qGcXzL6iaPYNFs34s3I_TP1Awvcfr3U01srsDR6fU="></p>
<p>For columns to merge, specify <strong>pickup_day</strong> and <strong>pickup_time</strong>.</p>
<p>For separator <strong>type a single space</strong>.</p>
<p>Name the new column <strong>pickup_datetime</strong>.</p>
<p>Preview and click <strong>Add</strong>.</p>
<p><img alt="d6a4d0d6a9a348ef.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/IFuDujr4jSdRBXaY33dyYBAkMO_BlWehmKUz0iyW9Z4="></p>
<p>Confirm your new field is properly registering now as a datetime datatype (clock icon).</p>
<p><img alt="9273009ca2303d8b.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/czxrMXxtY76jVUWeTqo6dP50_qGDo_6yIHdt7E_NMUU="></p>
<h4>Step 18</h4>
<p>Next, we want to <strong>create a new derived column</strong> to count the average amount of passengers in the last hour. To do that, we need to create to get hourly data and perform a calculation.</p>
<p>Find the <strong>Functions</strong> list in the navigation bar.</p>
<p>Select <strong>Dates and times</strong>.</p>
<p>Select <strong>DATEFORMAT</strong>.</p>
<p><img alt="9f634021f028bd3f.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/wJi1Ow0zWHl4G8KxPdrEo5qRrUOC7vbG2imqpkMClk0="></p>
<p>In the formula, paste the following which will truncate the pickup time to just the hour:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">DATEFORMAT</span><span class="pun">(</span><span class="pln">pickup_datetime</span><span class="pun">,</span><span class="str">"yyyyMMddHH"</span><span class="pun">)</span></code><button class="button button--copy js-copy-button-2"><i class="fa fa-clipboard"></i></button></pre>
<p><img alt="step_18.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/EYVefZ1hLy7i0LVfb_VgPp5bi5Y4q0rt+U7QHLhC7GY="></p>
<p>Specify the New Column as <strong>hour_pickup_datetime</strong>.</p>
<p>Confirm the new derived column is shown correctly in the <strong>preview</strong>.</p>
<p><img alt="step_18_a.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/qYH3SuM9zYf3XR4l3TdE80qZUWFWhbV5_+UIiwnSA_E="></p>
<p>Click <strong>Add</strong>.</p>
<h4>Step 19</h4>
<p>In order to get the field properly recognized as a DATETIME data type, we are going to add back zero minutes and zero seconds through a MERGE concatenation.</p>
<p>In the navigation bar, find <strong>Merge columns</strong>.</p>
<p><img alt="step_19.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/rBEdeIRoE7ZIv_91M4qfBa1VrT4yfSNH5LXg2DyA2rU="></p>
<p>For columns to merge, specify <strong>hour_pickup_datetime</strong> and <strong>'0000'</strong>.</p>
<p>Name the column to <strong>pickup_hour</strong>.</p>
<p><img alt="step_19_a.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/JviiixKL5pFr2y8zKfeUKbgFGrZ51mJJY6JuUiRyu_M="></p>
<p>Click <strong>Add</strong>.</p>
<p>We now have our taxicab hourly pickup column. Next, we will calculate the average count of passengers over the past hour. We will do this through aggregations and a rolling window average function.</p>
<h4>Step 20</h4>
<p>In the navigation toolbar select <strong>Functions</strong> &gt; <strong>Aggregation</strong> &gt; <strong>AVERAGE</strong>.</p>
<p><img alt="ad1bb11a7fba20b0.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/8BxKkXzasMWr9jLcGsjjBaf9iy8FzcFvTLvoh1j1+3k="></p>
<p>For <strong>Formula</strong>, specify:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">AVERAGE</span><span class="pun">(</span><span class="pln">fare_amount</span><span class="pun">)</span></code><button class="button button--copy js-copy-button-3"><i class="fa fa-clipboard"></i></button></pre>
<p>For <strong>Sort</strong> rows, specify:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">pickup_datetime</span></code><button class="button button--copy js-copy-button-4"><i class="fa fa-clipboard"></i></button></pre>
<p>For <strong>Group by</strong>, specify:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">pickup_hour</span></code><button class="button button--copy js-copy-button-5"><i class="fa fa-clipboard"></i></button></pre>
<p><img alt="step_20.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/HcxzfhGKKWyv+EfmXFgzsIaC9vGexZJ81ifrkQKMh1Y="></p>
<p>Click <strong>Add</strong>.</p>
<p>We now have our average cab fares statistic.</p>
<h4>Step 21</h4>
<p>Explore the <strong>average_fare_amount</strong> histogram. Is there a range of fares that are most common?</p>
<p><img alt="step_21.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/s98X+1xQQ5WitcGK7_zRKflU3BcKw37l1cWNGbnF9FI="></p>
<p>In our sample, most NYC cab fares are in the $12-13 range.</p>
<p>Next, we want to calculate a rolling window of average fares over the past 3 hours.</p>
<h4>Step 22</h4>
<p>In the navigation toolbar, select <strong>Functions</strong> &gt; <strong>Window</strong> &gt; <strong>ROLLINGAVERAGE</strong>.</p>
<p><img alt="3ba77249ce0b96b1.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/B3ayLIp1ywpj7Q87Es7bJ4hT9LSsQcqwtbgDsJWfdeM="></p>
<p>Copy in the below formula which computes the rolling average of passenger count for the last hour.</p>
<p>Formula:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pln">ROLLINGAVERAGE</span><span class="pun">(</span><span class="pln">average_fare_amount</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span></code><button class="button button--copy js-copy-button-6"><i class="fa fa-clipboard"></i></button></pre>
<p>Sort rows by:</p>
<pre><code class="language-bash prettyprint prettyprinted" style=""><span class="pun">-</span><span class="pln">pickup_hour</span></code><button class="button button--copy js-copy-button-7"><i class="fa fa-clipboard"></i></button></pre>
<p>Note that we are sorting recent taxicab rides first (the negative sign -<strong>pickup_hour</strong> indicates descending order) and operating over a rolling 3 hour period.</p>
<p><img alt="step_22.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/viUiTGXunoUSC4AWFAMcJODwDts0P9SRZ3PpyS9q3og="></p>
<p>Click <strong>Add</strong>.</p>
<h4>Step 23</h4>
<p>Toggle open the <strong>Recipe icon</strong> to preview your final transformation steps.</p>
<p><img alt="ac7bfdfafab6e41.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/1xx8rihGEJHALZwOj5PHfApDVWjXYqMqtTFLwbsSJLk="></p>
<p><img alt="step_23.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/YsYFzYWToBV7TAY4ezM2OsDqTVVNe6psw2MdHcXInmg="></p>
<h4>Step 24</h4>
<p>Click <strong>Run Job</strong>.</p>
<h4>Step 25</h4>
<p>In <strong>Publishing Actions page</strong>, under Settings, edit the path by clicking the pencil icon</p>
<p><img alt="step_25.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/zuDhH0MHvZXBGJjcGcww0ZiQ7VEC5KYrTdt3flstGzQ="></p>
<p>Choose <strong>BigQuery</strong> and choose your <strong>taxi_cab_reporting</strong> BigQuery dataset where you want to create the output table.</p>
<p>(<strong>Note:</strong> if you do not see a taxi_cab_reporting dataset, refer to the start of this lab for instructions on how to create it in BigQuery)</p>
<p>Choose <strong>Create a new table</strong>.</p>
<p>Name the table <strong>tlc_yellow_trips_reporting</strong>.</p>
<p>Choose <strong>Drop the table every run</strong>.</p>
<p>Select <strong>Update</strong>.</p>
<h4>Step 26</h4>
<p>Select <strong>Run Job</strong>.</p>
<h4>Step 27</h4>
<p>Optional: View the Cloud Dataflow Job by selecting [...] and <strong>View dataflow job</strong>.</p>
<p><img alt="step_27.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/wV+VSdEXMCL2JL_PRIQTPZjCsE741pAsWle1xt+0TFc="></p>
<p>Wait for your Cloud Dataflow job to complete and confirm your new new table shows in BigQuery.</p>
<h4>Step 28</h4>
<p>While your Cloud Dataprep flow starts and manages your Cloud Dataflow job, you can see the data results by running this pre-ran query in BigQuery:</p>
<pre><code class="language-sql prettyprint prettyprinted" style=""><span class="com">#standardSQL</span><span class="pln">
SELECT
  pickup_hour</span><span class="pun">,</span><span class="pln">
  FORMAT</span><span class="pun">(</span><span class="str">"$%.2f"</span><span class="pun">,</span><span class="pln">ROUND</span><span class="pun">(</span><span class="pln">average_3hr_rolling_fare</span><span class="pun">,</span><span class="lit">2</span><span class="pun">))</span><span class="pln"> AS avg_recent_fare</span><span class="pun">,</span><span class="pln">
  ROUND</span><span class="pun">(</span><span class="pln">average_trip_distance</span><span class="pun">,</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> AS average_trip_distance_miles</span><span class="pun">,</span><span class="pln">
  FORMAT</span><span class="pun">(</span><span class="str">"%'d"</span><span class="pun">,</span><span class="pln">sum_passenger_count</span><span class="pun">)</span><span class="pln"> AS total_passengers_by_hour
FROM
  </span><span class="str">`asl-ml-immersion.demo.nyc_taxi_reporting`</span><span class="pln">
ORDER BY
  pickup_hour DESC</span><span class="pun">;</span></code><button class="button button--copy js-copy-button-8"><i class="fa fa-clipboard"></i></button></pre>
<p>Extra credit:</p>
<p>You can schedule Cloud Dataprep jobs to run at set intervals. Select a flow and click [...] and <strong>Schedule Flow</strong>.</p>
<p><img alt="step_28.png" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/t8cQmy6zyji+6Z32Cs8gkn0kM7qlxcWr6jaeBQqlIWQ="></p>
<p>Congratulations! You have now built a data transformation pipeline using the Cloud Dataprep UI.</p>
<p>For full documentation and additional tutorials, refer to the  <a href="https://cloud.google.com/dataprep/">Cloud Dataprep support page</a>.</p>
<h2 id="step7">End your lab</h2>
<p>When you have completed your lab, click <strong>End Lab</strong>. Qwiklabs removes the resources you’ve used and cleans the account for you.</p>
<p>You will be given an opportunity to rate the lab experience. Select the applicable number of stars, type a comment, and then click <strong>Submit</strong>.</p>
<p>The number of stars indicates the following:</p>
<ul>
<li>1 star = Very dissatisfied</li>
<li>2 stars = Dissatisfied</li>
<li>3 stars = Neutral</li>
<li>4 stars = Satisfied</li>
<li>5 stars = Very satisfied</li>
</ul>
<p>You can close the dialog box if you don't want to provide feedback.</p>
<p>For feedback, suggestions, or corrections, please use the <strong>Support</strong> tab.</p>

<p>Last Tested Date: 12-05-2018</p>
<p>Last Updated Date: 12-05-2018</p>
<p>©2019 Google LLC All rights reserved. Google and the Google logo are trademarks of Google LLC. All other company and product names may be trademarks of the respective companies with which they are associated.</p>



</div>
<div class="js-lab-content-outline lab-content__outline">
<a href="https://googlecoursera.qwiklabs.com/focuses/35219#step1">Overview</a><a href="https://googlecoursera.qwiklabs.com/focuses/35219#step2">Setup</a><a href="https://googlecoursera.qwiklabs.com/focuses/35219#step3">Create a new Storage Bucket</a><a href="https://googlecoursera.qwiklabs.com/focuses/35219#step4">Create BigQuery Dataset to store Cloud Dataprep Output</a><a href="https://googlecoursera.qwiklabs.com/focuses/35219#step5">Launch Cloud Dataprep</a><a href="https://googlecoursera.qwiklabs.com/focuses/35219#step6">Import NYC Taxi Data from GCS into a Dataprep Flow</a><a href="https://googlecoursera.qwiklabs.com/focuses/35219#step7">End your lab</a>
</div>
</div>

</div>


</div>
</div>
<div class="lab-introduction js-lab-introduction is-hidden">
<div class="lab-introduction__inner">
<h1 class="headline-1">Welcome to Your First Lab!</h1>
<ql-icon-button class="js-skip-button">close</ql-icon-button>
<div class="lab-introduction__video">
<iframe allow="autoplay; encrypted-media" allowfullscreen="" frameborder="0" id="lab-introduction" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/yF7EDXKTmoQ.html"></iframe>
</div>
<a class="js-skip-button button button--outline">Skip this video</a>
</div>
</div>



</div>
</main>
<div class="modal fade" id="lab-details-modal">
<div class="modal-container">
<div class="mdl-shadow--24dp modal-content">
<div class="modal-body">
<p class="l-mbm">
In this lab you will ingest, transform, and analyze a taxi cab dataset using Google Cloud Dataprep. We will calculate key reporting metrics like the average number of passengers picked up in the past hour. 
</p>
<p class="small-label l-mbs">
<strong>
Duration:
</strong>
0m setup
·
120m access
·
90m completion
</p>
<p class="small-label l-mbs">
<span><strong>Levels: </strong>fundamental</span>
</p>
<p class="small-label">
<strong>
Permalink:
</strong>
<a href="https://googlecoursera.qwiklabs.com/catalog_lab/1951">https://googlecoursera.qwiklabs.com/catalog_lab/1951</a>
</p>
</div>
<div class="modal-actions">
<a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect" data-dismiss="modal" data-upgraded=",MaterialButton,MaterialRipple">
Got It
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
</div>


</div>
</div>
<iframe class="l-ie-iframe-fix" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/saved_resource(1).html"></iframe>
</div>
<div class="modal fade" id="lab-review-modal">
<div class="modal-container">
<div class="mdl-shadow--24dp modal-content">
<form class="simple_form js-lab-review-form" id="new_lab_review" action="https://googlecoursera.qwiklabs.com/lab_reviews" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="✓"><div class="modal-body">
<p class="label">
How satisfied are you with this lab?*
</p>
<div class="rateit js-rateit" data-rateit-max="5" data-rateit-min="0" data-rateit-resetable="false" data-rateit-step="1" data-rateit-value="0"><div class="rateit-reset" style="display: none;"></div><div class="rateit-range" style="width: 80px; height: 16px;"><div class="rateit-selected" style="height: 16px; width: 0px;"></div><div class="rateit-hover" style="height:16px"></div></div></div>
<div class="l-mtm">

<div class="control-group hidden lab_review_user_id"><div class="controls"><input class="hidden" type="hidden" value="1018107" name="lab_review[user_id]" id="lab_review_user_id"></div></div>
<div class="control-group hidden lab_review_classroom_id"><div class="controls"><input class="hidden" type="hidden" value="4478" name="lab_review[classroom_id]" id="lab_review_classroom_id"></div></div>
<div class="control-group hidden lab_review_lab_id"><div class="controls"><input class="hidden" type="hidden" value="1951" name="lab_review[lab_id]" id="lab_review_lab_id"></div></div>
<div class="control-group hidden lab_review_focus_id"><div class="controls"><input class="hidden" type="hidden" value="35219" name="lab_review[focus_id]" id="lab_review_focus_id"></div></div>
<div class="control-group hidden lab_review_rating"><div class="controls"><input class="hidden js-rating-input" type="hidden" name="lab_review[rating]" id="lab_review_rating"></div></div>
<div class="control-group text optional lab_review_comment"><label class="text optional control-label" for="lab_review_comment">Comment</label><div class="controls"><textarea class="text optional" name="lab_review[comment]" id="lab_review_comment"></textarea></div></div>
</div>
</div>
<div class="modal-actions">
<a class="mdl-button mdl-button--primary mdl-js-button mdl-js-ripple-effect" data-dismiss="modal" data-upgraded=",MaterialButton,MaterialRipple">
Cancel
<span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></a>
<input type="submit" name="commit" value="Submit" disabled="disabled" class="btn mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--primary" id="submit" data-disabled="false" data-disable-with="Submit" data-upgraded=",MaterialButton,MaterialRipple"><span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></input>
</div>
</form>

</div>
</div>
<iframe class="l-ie-iframe-fix" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/saved_resource(2).html"></iframe>
</div>

<script>
  $( function() {
    ql.initMaterialInputs();
    initChosen();
    initSearch();
    initTabs();
    ql.list.init();
    ql.favoriting.init();
    ql.header.myAccount.init();
    initTooltips();
    ql.autocomplete.init();
    ql.modals.init();
    ql.toggleButtons.init();
    ql.analytics.init();
    initLabContent( );
  ql.labOutline.links.init();
  ql.labOutline.layout.init();
  initLabReviewModal();
  ql.labAssessment.init();
  ql.labIntroduction.init( true );
  ql.labData.init();
  initLabTranslations( {"are_you_sure":"All done? If you end this lab, you will lose all your work. You may not be able to restart the lab if there is a quota limit. Are you sure you want to end this lab?\n","in_progress":"*In Progress*","ending":"*Ending*","starting":"*Starting, please wait*","end_concurrent_labs":"Sorry, you can only run one lab at a time. To start this lab, please confirm that you want all of your existing labs to end.\n","copied":"Copied","no_resource":"Error retrieving resource.","no_support":"No Support","mac_press":"Press ⌘-C to copy","thanks_review":"Thanks for reviewing this lab.","windows_press":"Press Ctrl-C to copy","days":"days"} );
  ql.labRun.init();
  ql.initHeader();
  ql.navigation.init();
  ql.navPanel.init();
  ql.navigation.init();
  
  });
</script>
<style>
  .mdl-layout__container {
    position: static
  }
</style>


<iframe data-product="web_widget" title="No content" tabindex="-1" aria-hidden="true" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/saved_resource(3).html" style="width: 0px; height: 0px; border: 0px; position: absolute; top: -9999px;"></iframe><div><iframe title="Opens a widget where you can find more information" id="launcher" tabindex="-1" class="zEWidget-launcher " style="border: none; background: transparent; z-index: 999998; transform: translateZ(0px); position: fixed; transition: opacity 250ms cubic-bezier(0.645, 0.045, 0.355, 1) 0s, top, bottom; opacity: 0; width: 113px; height: 50px; max-height: 551px; min-height: 50px; margin: 10px 20px; top: -9999px; visibility: hidden;" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/saved_resource(4).html"></iframe></div><div><iframe title="Find more information here" id="webWidget" tabindex="-1" class="zEWidget-webWidget " style="border: none; background: transparent; z-index: 999999; transform: translateZ(0px); position: fixed; transition: opacity 250ms cubic-bezier(0.645, 0.045, 0.355, 1) 0s, top, bottom; opacity: 0; width: 357px; height: 100%; max-height: 565px; min-height: 150px; margin-left: 8px; margin-right: 8px; top: -9999px; visibility: hidden;" src="./Computing Time-Windowed Features in Cloud Dataprep _ Qwiklabs_files/saved_resource(5).html"></iframe></div></body></html>